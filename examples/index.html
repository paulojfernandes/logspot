<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>jQuery-handlebars Example</title>

    <!--Font-->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" />
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
        crossorigin="anonymous">

    <!--Mobile Specific Metas-->
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <style>
        /*Body styling*/
        
        body {
            font-family: 'Open Sans', sans-serif, Arial;
        }
    </style>
</head>

<body>
    <h1>Teste Servidor</h1>

    <!--START: Content element-->
    <div id="content">
        <p></p>
        <p>Teste BD (real time)
        </p>
        <script id="template3" type="text/x-handlebars-template" data-template-example="">
            <h1> {{name}}</h1>
            {{#each dados}}
            <p> {{mac}}</p>
            <p> {{ssid}}</p>

            {{/each}}
        </script>


        <script id="template2" type="text/x-handlebars-template" data-template-example="">

            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Id</th>
                        <th>Id Localização</th>
                    </tr>
                </thead>
                <tbody>
                    {{#each dados}}
                    <tr>
                        <td>{{nome}}</td>
                        <td>{{id_empresa}}</td>
                        <td>{{id_contacto}}</td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>

        </script>

        <script id="template" type="text/x-handlebars-template" data-template-example="">


            <div class="row">

                <div class="col-md-8">
                    <H1>Adicionar Empresa:</H1>
                    <form action="http://127.0.0.1:3000/home" method="post">
                        <div class="form-group">
                            <label for="formGroupExampleInput">Nome</label>
                            <input type="text" class="form-control" id="nome" name="nome" placeholder="Nome Empresa">
                        </div>

                        <button type="submit" id="enviar" class="btn btn-primary">Inserir</button>
                    </form>
                </div>
            </div>
        </script>




        <script>
            // This will NOT be removed from the DOM
            document.getElementById('content');
        </script>

        <!--The following nodes will not be destroyed-->
        This TEXT node will NOT be destroyed each time the plugin is called
        <p>This P ELEMENT node will NOT be destroyed</p>
    </div>
    <!--END: Content element-->

    <!--<button type="button" id="btn1" class="btn btn-default">Pagina1</button>
    <button type="button" id="btn2" class="btn btn-default">Pagina2</button>
    <button type="button" id="btn3" class="btn btn-default">Pagina3</button>
    <button type="button" id="pedido" class="btn btn-default">Pedido</button>-->

    <!--Scripts-->
    <script src="https://code.jquery.com/jquery-2.2.3.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js"></script>
    <script src="https://ipppt-my.sharepoint.com/personal/9150293_esmad_ipp_pt/_layouts/15/guestaccess.aspx?docid=1ec6efa9a36e64335b8cb81f5224e5f8b&authkey=Ae0tFaBNriVG5m8r1vDea9Y"></script>
    <!--<script src="https://localhost:3000/static/index.js"></script>-->

    <script>
        $(function domReady($) {
            // Cache the jQuery object
            var $content = $('#content');


            $content.handlebars('add', '#template', { remove: false });
            // $content.handlebars('add', '#template2', { remove: false });











            // Testing only!

            // $content.handlebars('remove', '#template'); // Remove single template id
            // $content.handlebars('remove'); // Remove all templates
            window.console.log('Rendered templates: %o', $content.handlebars('get')); // Get the rendered templates for the content element
            window.console.log('Compiled templates: %o', $content.handlebars('compiled')); // Get the compiled templates for the content element
        });
    </script>


    <script type="text/javascript">
        var $content = $('#content');
        $(function () {

            function atualizar() {
                console.log("entrei")

                //query2()

                var request = $.ajax({
                    type: 'POST',
                    dataType: "json",
                    contentType: 'application/json',
                    url: 'http://logspotk.webitcloud.net/home3'
                });
                request.done(function (data) {
                    //alert(JSON.stringify(data))
                    context = { name: data };
                    console.log(context)
                    // $content.handlebars('remove', '#template2', context, { remove: false });
                    $content.handlebars('add', '#template3', context, { remove: false });
                })

            };
            function atualizar2() {
                console.log("entrei")

                //query2()

                var request = $.ajax({
                    type: 'POST',
                    dataType: "json",
                    contentType: 'application/json',
                    url: 'https://logspotk.webitcloud.net/home4'
                });
                request.done(function (data) {
                    //alert(JSON.stringify(data))
                    context = { dados: data };
                    console.log(context)
                    //$content.handlebars('remove', '#template2', context, { remove: false });
                    $content.handlebars('add', '#template3', context, { remove: false });
                })

            };


            $('#enviar').click(function (e) {
                e.preventDefault();


                var data = {};
                data.nome = $('#nome').val();
                $('#nome').val("");

                console.log(data);

                $.ajax({
                    type: 'POST',
                    data: JSON.stringify(data),
                    contentType: 'application/json',
                    url: 'https://localhost:3000/home',
                    success: function (data) {
                        console.log('success:');
                        console.log(JSON.stringify(data));
                        atualizar()

                    }
                });

            });

            atualizar()
            atualizar2()
        });
    </script>




</body>

</html>
